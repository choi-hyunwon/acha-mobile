<!DOCTYPE html>
<html lang="ko">
@@include('../include/head.html')

<body>
	<div class="wrap renewal">
		<div class="header _sticky">
			<a href="#" class="sprite btn_back"></a>
			<h2>현금 직접 입력</h2>
		</div>
		<div class="contents expenditure">
			<div class="expenditure-tab _expenditureTab block-tab">
				<ul>
					<li class="active"><a href="#">수입</a></li>
					<li><a href="#">지출</a></li>
				</ul>
			</div>
			<div class="expenditure-box">
				<div class="box_my_income_add">
					<form action="#">
						<fieldset>
							<div class="custom-light _focus">
								<label class="title">수입명</label>
								<input title="value" type="text" maxlength="12" onkeyup="countCharDelete(this,'_val')"
									placeholder="수입명을 적어주세요" />
								<div class="input-byte mt-0"><span class="byte _val">0</span><span class="total"> /
										12</span></div>
							</div>
							<div class="custom-light monetary-unit _focus">
								<label class="title">수입 금액</label>
								<input onkeyup="countCharDelete(this)" title="value" type="number"
									placeholder="금액을 입력해주세요" />
								<p class="sub-desc">10억원 미만까지 입력 가능</p>
							</div>
							<div class="custom-light select-category">
								<label class="title">수입 일시</label>
								<input id="db1" name="db1" type="text" data-role="datebox" readonly="readonly" placeholder="수입 일시를 입력해주세요" value="2023년 6월 25일 오후 6:54">
							</div>

							<div class="custom-light switch-split">
								<div class="wrap-title">
									<p class="title">매월 수입으로 등록</p>
									<!-- <p class="sub-desc">28일 이후 수입은 매월 28일 수입으로 적용돼요</p> -->
								</div>
								<div class="custom-switch">
									<input type="checkbox" class="custom-control-input" id="switch1">
									<label class="custom-control-label" for="switch1"></label>
								</div>
							</div>
							<div class="custom-light select-category">
								<label class="title">입금 수단</label>
								<input title="value" type="text" placeholder="입금 수단을 선택해주세요" value="현금" readonly />
							</div>
							<div class="custom-light select-category">
								<label class="title">수입 카테고리</label>
								<input title="value" type="text" placeholder="수입 카테고리를를 선택해주세요" value="기타" readonly />
							</div>
							<div class="custom-light income-memo">
								<label class="title">수입 메모</label>
								<div class="textarea-label">
									<textarea name="수입 메모" id="val-textarea" class="textarea" maxlength="60"
										onkeyup="countCharDelete(this,'_val')" placeholder="메모를 입력해주세요"
										rows="1"></textarea>
									<div class="input-byte mt-0"><span class="byte _val">0</span><span
											class="total">/60</span></div>
								</div>
							</div>
							<div class="btn_area">
								<a class="btn btn-big btn-purple-bg btn-block disabled" href="#">저장하기</a>
							</div>
						</fieldset>
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
$(document).ready(function () {
	$(".custom-control-input").on("click", function () {
		$(this).toggleClass("off");
		if ($(this).hasClass("off")) {
			$("._off").addClass("active");
			$("._on").removeClass("active");
		} else {
			$("._on").addClass("active");
			$("._off").removeClass("active");
		}
	});

	const DEFAULT_HEIGHT = 0;
	const $textarea = document.querySelector('.textarea');
	
	$textarea.oninput = (e) => {
		const $target = e.target;
		$target.style.height = 0;
		$target.style.height = DEFAULT_HEIGHT + $target.scrollHeight + 'px';
	};
});

(function($) {
  const originalBuild = $.jtsage.datebox.prototype._build.datetimeflipbox;

  $.jtsage.datebox.prototype._build.datetimeflipbox = function () {
    originalBuild.call(this);

    const wrapper = this.d.intHTML.find(".dbRollerV");
    let rollers = wrapper.children(".dbRollerC");

	if(rollers.length > 6){
		rollers.eq(5).remove();
	}

	rollers = wrapper.children(".dbRollerC");

	const ampm = rollers.last();
	const targetIndex = 3;
	ampm.insertBefore(rollers.eq(targetIndex));

	const order = ['y', 'm', 'd', 'a', 'h', 'i'];
    this._dbox_vswap = order;
	
	this._dbox_vlist = [];
    const newRollers = wrapper.children(".dbRollerC");
    newRollers.each((index, elem) => {
      this._dbox_vlist.push({
        field: order[index],
        row: $(elem).find("ul")
      });
    });

	const activeEl1 = $("<div class='custom-picker-date1'><span></span><span></span><span></span></div>");
	const activeEl2 = $("<div class='custom-picker-date2'><span></span><span></span><span></span></div>");
	const activeEl3 = $("<div class='custom-picker-date3'><span></span><span></span><span></span></div>");
	const activeEl4 = $("<div class='custom-picker-date4'><span></span><span></span><span></span></div>");
    
	if (!wrapper.find(".custom-picker-date").length) {
		wrapper.after(activeEl4, activeEl3, activeEl2, activeEl1);
    }
  };
})(jQuery);

jQuery.extend(jQuery.jtsage.datebox.prototype.options.lang, {
	'ko': {
		setDateButtonLabel: "설정",
		cancelButton: "취소",
		calTodayButtonLabel: "오늘",
		monthsOfYear: ["1","2","3","4","5","6", "7","8","9","10","11","12"],
		monthsOfYearShort: ["1","2","3","4","5","6", "7","8","9","10","11","12"],
		daysOfWeek: ["일","월","화","수","목","금","토"],
		meridiem: ["오전", "오후"]
	}
});

jQuery.extend(jQuery.jtsage.datebox.prototype.options, {
	useLang: 'ko',
})

$(document).on("dateboxcreate", function(e) {
	const widget = $(e.target).data('datebox');
	if (!widget) return
	widget.options.monthsOfYear = ["1","2","3","4","5","6", "7","8","9","10","11","12"];
	widget.options.monthsOfYearShort = ["1","2","3","4","5","6", "7","8","9","10","11","12"];
	widget.options.meridiem = ["오전", "오후"];
})

$('#db1').datebox({
	mode: 'datetimeflipbox',
	displayMode: 'modal',
	useFocus: true,
	useHeader: false,
    useCancelButton: true,
	overrideDateFormat: "%Y년 %m월 %d일",
	overrideTimeFormat: "%p %l:%M",
	datetimeFieldOrder: ['y', 'm', 'd', 'h', 'i', 'a'],
	overrideTimeFormat: 12,
	minuteStep: 1,
}).on("change", function () {
	let selectedDate = $(this).datebox("getTheDate");
	let rawFormat = $(this).datebox("callFormat", "%Y년 %m월 %d일 %p %l:%M", selectedDate);
	let formattedDate = rawFormat.replace("AM", "오전").replace("PM", "오후");
	$(this).val(formattedDate);
});
</script>


@@include('../include/countCharDelete.html')
</html>